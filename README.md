# Работа с локальными SVN-репозиториями в Altium Designer

## Содержание

1. [Создание SVN-репозитория](#создание-svn-репозитория)
2. [Подключение к существующему SVN-репозиторию](#подключение-к-существующему-репозиторию)
3. [Подключение проекта из SVN-репозитория ](#подключение-проектов-из-svn-репозитория)
4. [Создание проекта с системой контроля версий](#создание-проекта-с-системой-контроля-версий)
5. [Загрузка проекта в SVN-репозиторий](#загрузка-проекта-в-svn-репозиторий)
6. [Добавление и обновление файлов](#добавление-и-обновление-файлов)




## Создание SVN-репозитория

1. Заходим в настройки репозиториев: Preferences -> Data Management (`1`) -> Design Repositories (`2`):

![Design Repositories](imgs/design_repositories.png "Меню Design Repositories")

(`3`) - Список подключенных репозиториев, их тип, путь к репозиторию и статус (зелёная галочка, если подключение успешно);

(`4`) - Создание нового репозитория;

(`5`) - Подключение к уже существующему репозиторию.

2. Нажимаем на кнопку `Create New` и выбираем тип `SVN`:

![](imgs/create_new.png "Создание SVN-репозитория")

3. В открывшемся меню настраиваем параметры нового репозитория:

![](imgs/create_new_properties.png "Параметры создания нового репозитория")

(`1`) - Название репозитория (на английском и без пробелов);

(`2`) - Путь на локальном компьютере, куда будут выгружены файлы проекта;

(`3`) - Метод подключения (выбираем `file`, если репозиторий лежит в общей папке);

(`4`) - Папка, в которой будет находиться сам репозиторий и к которой необходимо подключиться;

> Altium позволяет использовать пробелы и русские символы в пути к папкам, но некорректно их отображает

(`5`) - После заполнения все параметров нажимаем `OK` и репозиторий создан.




## Подключение к существующему репозиторию

1. Заходим в настройки репозиториев: Preferences -> Data Management (`1`) -> Design Repositories (`2`):

![Design Repositories](imgs/design_repositories.png "Меню Design Repositories")

2. Нажимаем на кнопку `Connect To` и выбираем тип `SVN`:

![](imgs/connect_to.png "Подключение к SVN-репозиторию")

3. В открывшемся меню настраиваем параметры подключения:

![](imgs/connect_to_properties.png "Параметры создания нового репозитория")

(`1`) - Название репозитория (то, как он будет называться в других меню Altium);

(`2`) - Путь на локальном компьютере, куда будут выгружены файлы проекта;

(`3`) - Метод подключения (выбираем `file`, если репозиторий лежит в общей папке);

(`4`) - Папка, в которой находится репозиторий;

(`5`) - Подпапка репозитория (если есть);

(`6`) - Проверка подключения к репозиторию;

Если подключение успешно:

![](imgs/test_ok.png "Подключение успешно")

Если подключение не было осуществлено (в данном случае намеренно был искажён путь до репозитория):

![](imgs/test_error.png "Ошибка подключения")

(`7`) - После заполнения все параметров нажимаем `OK` и репозиторий создан.




## Подключение проектов из SVN-репозитория 

1. Для выгрузки проектов из репозитория зайти в меню `File` и выбрать опцию `Check Out...`

![File -> Check Out](imgs/file_check_out.png)

2. В меню `Check Out...` необходимо установить следующие опции:

(`1`) - Выбрать нужный репозиторий (если их несколько);
(`2`) - Выбрать проект из репозитория;
(`3`) - Выбор пути, где будут лежать файлы проекта;
(`4`) - Подтверждение выбора;

![Меню Check Out](imgs/check_out.png)

3. Загруженный проект выглядит так:

![Загруженный проект](imgs/downloaded_project.png)

> Отметки напротив файла соответствуют его статусу:
> - Зелёная галочка - файл на компьютере синхронизирован с репозиторием
> - Красный кружок - файл на компьютере содержит изменения, которых нет в репозитории
> - Жёлтые восклицательные знаки - файл на компьютере не синхронизирован, в репозитории лежит новая версия (при обновлении возможен mrege conflict, осторожнее)
> - Синий крестик - файл будет добавлен в следующем коммите




## Создание проекта с системой контроля версий

Для создания проекта в созданном репозитории в меню `Create Project` в поле `Locations` выбрать опцию `Version control` (`1`). 

![Создание проекта с СКВ](imgs/create_project_snv.png)

Далее установить следующие параметры:

(`2`) - Тип проекта;

(`3`) - Название проекта;

(`4`) - Название используемого репозитория;

(`5`) - Папка внутри репозитория, где будет находиться проект;

(`6`) - Папка на компьютере, где будут лежать файлы проекта.

Далее нажать `Create`. Проект создан.




## Загрузка проекта в SVN-репозиторий

Для загрузки локального проекта в SVN репозиторий необходимо в меню проекта выбрать вкладку `History & Version Control`, а в ней опцию `Add projects to Version Control...`.

![Добавление в СКВ](imgs/version_control_add.png)

В появившемся меню необходимо настроить опции добавления.

![Добавление в СКВ](imgs/add_to_version_control.png)

(`1`) - Выбор репозитория, в который добавится проект;

(`2`) - Выбор уже существющей папки в репозитории;

(`3`) - Создание новой (по умолчанию создаётся с названием проекта) - предпочтительный вариант;

(`4`) - Подтверждение выбора.

Далее необходимо выбрать файлы для добавления.
> Важно! В репозиторий не получится загрузить библиотеки, не лежащие в папке проекта (например, общие библиотеки на сетевом диске).

![Добавление файлов в репозиторий](imgs/add_to_vsc_files.png)

После выбора файлов нажать `OK`. Итоги добавления файлов:

![Результат](imgs/vcs_results.png)




## Добавление и обновление файлов

Для того, чтобы добавить новый файл в систему контроля версий в опциях файла
выбрать вкладку `History & Version Control`, а в ней опцию `Add to Version Control...`.

![Добавить файл в VCS](imgs/add_to_vcs_file.png)

После этого напротив файла появится пиктограмма (синий крестик).

![Добавить файл в VCS](imgs/add_to_vcs_file_result.png)

Для синхронизации версий проекта в репозитории и на компьютере необходимо сделать коммит. 

При внесении изменений в файл, включенный в систему контроля версий, напротив его названия появится пиктограмма (красный кружок). Для внесения изменений в репозиторий тоже необходимо сделать коммит (файла или всего проекта). 

Возможен коммит одного конкретного файла: 

![Commit файла](imgs/file_commit.png)

Либо коммит всего проекта (целесообразно, если изменено сразу несколько файлов):

![Commit проекта](imgs/project_commit.png)

Любой коммит содержит в себе комментарий. Рекомендуется, чтобы он был содержательным (для простоты поиска в будущем). По нажатию кнопки `OK` коммит будет влит в репозиторий.

![alt text](imgs/commit_comment.png)
